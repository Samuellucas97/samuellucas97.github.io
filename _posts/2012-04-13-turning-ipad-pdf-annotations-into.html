---
layout: post
title: Turning iPad PDF annotations into anonymous reviews
date: '2012-04-13T15:58:00.000+02:00'
author: Andreas Zeller
tags: 
modified_time: '2012-10-15T10:37:24.103+02:00'
blogger_id: tag:blogger.com,1999:blog-8747085902902510837.post-9128129060844011472
blogger_orig_url: https://andreas-zeller.blogspot.com/2012/04/turning-ipad-pdf-annotations-into.html
---

<b>Update:</b>&nbsp;Updated script to 1.1 (2012-15-10)<br /><br />As a researcher, I frequently peer review the papers of other researchers. &nbsp;The standard way to do this is to print out the paper, make handwritten notes on it, and then convert it all into a written, anonymous review text that gets sent to the committee and the authors. &nbsp;Recently, I have started reading papers on my iPad â€“ it's more colorful, more interactive, and more portable. &nbsp;Using <a href="http://www.goodiware.com/goodreader.html" target="_blank">GoodReader</a>, I can annotate the papers, too. &nbsp;But how do I get these annotations into a text that I can send as a review?<br /><br />Let me show where the problem is. &nbsp;In the paper to review, I highlight a passage:<br /><blockquote class="tr_bq"><span class="Apple-style-span" style="font-family: 'Trebuchet MS', sans-serif;">In fact, <span class="Apple-style-span" style="background-color: yellow;">building large applications takes minutes to hours</span>. This is unacceptable.</span></blockquote><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">and add a note "An incremental rebuild would be much faster. Please discuss." to the highlighted passage. (In GoodReader, you get this by tapping on the highlighted text and selecting "Open"). &nbsp;In a PDF viewer, this nicely translates into a highlighted section with a note. &nbsp;For my students, this is fine. &nbsp;My anonymous review, however, is supposed to come in text.&nbsp;&nbsp;I can use GoodReader to turn the annotations into text:</div><br /><blockquote class="tr_bq"><span class="Apple-style-span" style="font-family: 'Trebuchet MS', sans-serif;">Highlight, 12.04.2012 09:52, Andreas Zeller:<br />But an incremental rebuild would be much faster. Please discuss.</span></blockquote>The problem is obvious: it lacks context (where exactly is the problem?), and won't be helpful for the author. &nbsp;So I wrote a script for my Mac with which my annotations read like this:<br /><br /><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: Helvetica;"></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"></div><blockquote class="tr_bq"><span class="Apple-style-span" style="font-family: 'Trebuchet MS', sans-serif;">Page 2 "building large applications takes minutes to hours": But an incremental rebuild&nbsp;would be much faster. Please discuss.</span></blockquote><div>This way, the author knows precisely where the issue is; and I can nicely combine markup and comments in one single step.</div><div><br /></div><div>The script leverages the free <a href="http://skim-app.sourceforge.net/" target="_blank">Skim PDF viewer</a> and converts the annotations into the form above. &nbsp;Paste it into <a href="http://developer.apple.com/library/mac/#documentation/applescript/conceptual/applescriptx/Concepts/work_with_as.html" target="_blank">AppleScript Editor</a> and run it while Skim shows the annotated PDF; the extracted summary will show up in a TextEdit window. &nbsp;Enjoy!<br /><br /><br /><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- This script supports anonymous reviews of documents (e.g., submitted scientific papers) via PDF annotations.&nbsp; It takes an annotated PDF (opened in the Skim PDF viewer) and produces a list of annotations in a form that is easy to edit; this list is copied to the clipboard and also opened in TextEdit. My typical workflow with this script is as follows.</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- 1. I have the PDFs to be annotated in DropBox.</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- 2. I annotate them on my iPad using GoodReader (other programs creating standard PDF annotations should work just as well).&nbsp; I use the following markups:</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- &nbsp; &nbsp; * UNDERLINE means something straightforward to fix (e.g. typos)</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- &nbsp; &nbsp; * STRIKEOUT means something to delete</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- &nbsp; &nbsp; * HIGHLIGHT means something to comment upon</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- 3. I add NOTES to these annotations (especially the highlights) to comment on text-specific issues.</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- 4. I also add non-anchored notes for general comments not related to a speficic piece of text; this is where the summary and the general assessment goes.</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- 5. After editing, I again sync with DropBox and open the PDF in Skim on my Mac.&nbsp; Then I run this script, and get the summary in my preferred format in a TextEdit window.</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- 6. I edit the script where needed, and integrate it into the official review form.</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- One can easily extend this script to differentiate more kinds of notes or attributes.</div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; min-height: 15px; text-indent: -39.3px;"><br /></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- Enjoy!</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- Andreas Zeller &lt;zeller@cs.uni-saarland.de&gt;, 2012-10-15</div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; min-height: 15px; text-indent: -39.3px;"><br /></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- Revision Notes</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- 2012-04-15: Revision 1.0</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- Initial Release</div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; min-height: 15px; text-indent: -39.3px;"><br /></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- 2012-10-15: Revision 1.1</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- Adapted for Skim 1.3.22 (extended notes)</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- New: ignore highlight notes without associated text</div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; min-height: 15px; text-indent: -39.3px;"><br /></div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; min-height: 15px; text-indent: -39.3px;"><br /></div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;"><b>tell</b> <span style="color: #0433ff;"><i>application</i></span> "Skim"</div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> <span style="color: #4f8f00;">res</span> <b>to</b> ""</div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; min-height: 15px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span>-- All of this only works with Skim notes, so we convert first<span class="Apple-tab-span" style="white-space: pre;"> </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>try</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> <span style="color: #4f8f00;">documentName</span> <b>to</b> <span style="color: #812fdc;">name</span> <b>of</b> <span style="color: #0433ff;"><i>document</i></span> 1</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> <span style="color: #4f8f00;">closeAtExit</span> <b>to</b> 0</div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>on</b> <b>error</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><span style="color: #0433ff;"><b>open</b></span> (<span style="color: #012fbe;"><b>choose file</b></span> <span style="color: #012fbe;">with prompt</span> "Select annotated PDF file")</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span></span>-- display dialog "Please open the annotated PDF in Skim." buttons {"Quit"}</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span></span>-- error number -128</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> <span style="color: #4f8f00;">closeAtExit</span> <b>to</b> 1</div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>end</b> <b>try</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; min-height: 15px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> <span style="color: #4f8f00;">documentName</span> <b>to</b> <span style="color: #812fdc;">name</span> <b>of</b> <span style="color: #0433ff;"><i>document</i></span> 1</div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> <span style="color: #4f8f00;">documentFile</span> <b>to</b> <span style="color: #0433ff;"><i>file</i></span> <b>of</b> <span style="color: #0433ff;"><i>document</i></span> 1</div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; min-height: 15px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>if</b> <span style="color: #812fdc;">modified</span> <b>of</b> <span style="color: #0433ff;"><i>document</i></span> 1 <b>then</b></div><div style="color: #0433ff; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span></span><b>save</b><span style="color: black;"> </span><i>document</i><span style="color: black;"> 1</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>end</b> <b>if</b></div><div style="color: #0433ff; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><b>convert notes</b><span style="color: black;"> (</span><i>document</i><span style="color: black;"> 1)</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; min-height: 15px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> <span style="color: #4f8f00;">res</span> <b>to</b> <span style="color: #4f8f00;">res</span> &amp; "== " &amp; <span style="color: #812fdc;">name</span> <b>of</b> <span style="color: #0433ff;"><i>document</i></span> 1 &amp; "&nbsp; =="</div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; min-height: 15px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> <span style="color: #4f8f00;">pageNotes</span> <b>to</b> <span style="color: #0433ff;"><i>notes</i></span> <b>of</b> <span style="color: #0433ff;"><i>document</i></span> 1</div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; min-height: 15px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>repeat</b> <b>with</b> </span>currentNote<span style="color: black;"> <b>in</b> </span>pageNotes</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; min-height: 15px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span></span>-- display dialog type of currentNote as string</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; min-height: 15px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> <span style="color: #4f8f00;">notePage</span> <b>to</b> <b>the</b> <span style="color: #812fdc;">index</span> <b>of</b> <b>the</b> <span style="color: #0433ff;"><i>page</i></span> <b>of</b> <span style="color: #4f8f00;">currentNote</span></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> </span>noteType<span style="color: black;"> <b>to</b> <b>the</b> </span><span style="color: #0433ff;"><i>type</i></span><span style="color: black;"> <b>of</b> </span>currentNote</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> <span style="color: #4f8f00;">textForNote</span> <b>to</b> <span style="color: #812fdc;">return</span> &amp; "Page " &amp; <span style="color: #4f8f00;">notePage</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> <span style="color: #4f8f00;">skipNote</span> <b>to</b> 0</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; min-height: 15px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span></span>-- add anchor if present</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>try</b></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> </span>noteSelection<span style="color: black;"> <b>to</b> <b>the</b> </span><span style="color: #812fdc;">selection</span><span style="color: black;"> <b>of</b> </span>currentNote<span style="color: black;"> <b>as</b> </span><span style="color: #0433ff;"><i>text</i></span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>on</b> <b>error</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">noteSelection</span> <b>to</b> "(SELECTION)"</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>end</b> <b>try</b></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> </span>s<span style="color: black;"> <b>to</b> </span>noteSelection</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>if</b> <span style="color: #4f8f00;">s</span> <b>is</b> <b>not</b> "missing value" <b>then</b></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">   </span></span>-- remove newlines</div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">s</span> <b>to</b> <b>my</b> <span style="color: #4f8f00;">replace_chars</span>(<span style="color: #4f8f00;">s</span>, <span style="color: #812fdc;">return</span>, " ")</div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">s</span> <b>to</b> <b>my</b> <span style="color: #4f8f00;">replace_chars</span>(<span style="color: #4f8f00;">s</span>, <span style="color: #012fbe;"><b>ASCII character</b></span> 10, " ")</div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; min-height: 15px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">   </span></span>-- remove hyphens</div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">s</span> <b>to</b> <b>my</b> <span style="color: #4f8f00;">replace_chars</span>(<span style="color: #4f8f00;">s</span>, "- ", "")</div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; min-height: 15px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">   </span></span>-- trim text</div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>repeat</b> <b>until</b> <span style="color: #4f8f00;">s</span> <b>does not</b> <b>start with</b> " "</div><div style="font-family: Verdana; font-size: 12px; margin-left: 196.4px; text-indent: -196.4px;"><span class="Apple-tab-span" style="white-space: pre;">    </span><b>set</b> <span style="color: #4f8f00;">s</span> <b>to</b> <span style="color: #0433ff;"><i>text</i></span> 2 <b>thru</b> -1 <b>of</b> <span style="color: #4f8f00;">s</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>end</b> <b>repeat</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; min-height: 15px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>repeat</b> <b>until</b> <span style="color: #4f8f00;">s</span> <b>does not</b> <b>end</b> <b>with</b> " "</div><div style="font-family: Verdana; font-size: 12px; margin-left: 196.4px; text-indent: -196.4px;"><span class="Apple-tab-span" style="white-space: pre;">    </span><b>set</b> <span style="color: #4f8f00;">s</span> <b>to</b> <span style="color: #0433ff;"><i>text</i></span> 1 <b>thru</b> -2 <b>of</b> <span style="color: #4f8f00;">s</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>end</b> <b>repeat</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; min-height: 15px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">textForNote</span> <b>to</b> <span style="color: #4f8f00;">textForNote</span> &amp; " \"" &amp; <span style="color: #4f8f00;">s</span> &amp; "\""</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>end</b> <b>if</b></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> </span>textForNote<span style="color: black;"> <b>to</b> </span>textForNote<span style="color: black;"> &amp; ":"</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; min-height: 15px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span></span>-- add note type</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> <span style="color: #4f8f00;">t</span> <b>to</b> <b>the</b> <span style="color: #0433ff;"><i>type</i></span> <b>of</b> <span style="color: #4f8f00;">currentNote</span> <b>as</b> <span style="color: #0433ff;"><i>text</i></span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>if</b> <span style="color: #4f8f00;">t</span> <b>is</b> "strike out note" <b>then</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">t</span> <b>to</b> " please delete."</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>else</b> <b>if</b> <span style="color: #4f8f00;">t</span> <b>is</b> "underline note" <b>then</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">t</span> <b>to</b> " please fix."</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>else</b> <b>if</b> <span style="color: #4f8f00;">t</span> <b>is</b> "highlight note" <b>then</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">t</span> <b>to</b> ""</div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> </span><span style="color: #4f8f00;">skipNote</span><span style="color: black;"> <b>to</b> 1 </span>-- ignore highlights unless with text</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>else</b> <b>if</b> <span style="color: #4f8f00;">t</span> <b>is</b> "anchored note" <b>or</b> <span style="color: #4f8f00;">t</span> <b>is</b> "text note" <b>then</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">t</span> <b>to</b> ""</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>end</b> <b>if</b></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> </span>textForNote<span style="color: black;"> <b>to</b> </span>textForNote<span style="color: black;"> &amp; </span>t</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; min-height: 15px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span></span>-- add note text if relevant</div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>if</b> </span><span style="color: #0433ff;"><i>text</i></span><span style="color: black;"> <b>of</b> </span>currentNote<span style="color: black;"> <b>is</b> <b>not</b> </span>noteSelection<span style="color: black;"> <b>then</b></span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; min-height: 15px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> </span>textForNote<span style="color: black;"> <b>to</b> </span>textForNote<span style="color: black;"> &amp; " "</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; min-height: 15px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>if</b> <span style="color: #4f8f00;">t</span> <b>is</b> <b>not</b> "" <b>then</b></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 196.4px; text-indent: -196.4px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">    </span><b>set</b> </span>textForNote<span style="color: black;"> <b>to</b> </span>textForNote<span style="color: black;"> &amp; "("</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>end</b> <b>if</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; min-height: 15px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> </span>textForNote<span style="color: black;"> <b>to</b> </span>textForNote<span style="color: black;"> &amp; </span><span style="color: #0433ff;"><i>text</i></span><span style="color: black;"> <b>of</b> </span>currentNote</div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; min-height: 15px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>if</b> <span style="color: #812fdc;">extended text</span> <b>of</b> <span style="color: #4f8f00;">currentNote</span> <b>as</b> <span style="color: #0433ff;"><i>text</i></span> <b>is</b> <b>not</b> "missing value" <b>then</b></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 196.4px; text-indent: -196.4px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">    </span><b>set</b> </span>textForNote<span style="color: black;"> <b>to</b> </span>textForNote<span style="color: black;"> &amp; "&nbsp; " &amp; </span><span style="color: #812fdc;">extended text</span><span style="color: black;"> <b>of</b> </span>currentNote</div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>end</b> <b>if</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; min-height: 15px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>if</b> <span style="color: #4f8f00;">t</span> <b>is</b> <b>not</b> "" <b>then</b></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 196.4px; text-indent: -196.4px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">    </span><b>set</b> </span>textForNote<span style="color: black;"> <b>to</b> </span>textForNote<span style="color: black;"> &amp; ")"</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>end</b> <b>if</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">skipNote</span> <b>to</b> 0</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>end</b> <b>if</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; min-height: 15px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>if</b> <span style="color: #4f8f00;">skipNote</span> <b>is</b> 0 <b>then</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 157.1px; text-indent: -157.2px;"><span class="Apple-tab-span" style="white-space: pre;">   </span><b>set</b> <span style="color: #4f8f00;">res</span> <b>to</b> <span style="color: #4f8f00;">res</span> &amp; <span style="color: #4f8f00;">textForNote</span> &amp; <span style="color: #812fdc;">return</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>end</b> <b>if</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>end</b> <b>repeat</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; min-height: 15px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span>-- Copy result to clipboard</div><div style="color: #012fbe; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><b>set the clipboard to</b><span style="color: black;"> </span><span style="color: #4f8f00;">res</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; min-height: 15px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span>-- Go back to original file</div><div style="color: #0433ff; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><b>revert</b><span style="color: black;"> </span><i>document</i><span style="color: black;"> 1</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>if</b> <span style="color: #4f8f00;">closeAtExit</span> <b>is</b> 1 <b>then</b></div><div style="color: #0433ff; font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;">  </span></span><b>close</b><span style="color: black;"> </span><i>document</i><span style="color: black;"> 1</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>end</b> <b>if</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; min-height: 15px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span>-- display dialog ("You can now paste this text from the clipboard into your review form:" &amp; res)</div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;"><b>end</b> <b>tell</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; min-height: 15px; text-indent: -39.3px;"><br /></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- Now open TextEdit with the summary</div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;"><b>tell</b> <span style="color: #0433ff;"><i>application</i></span> "TextEdit"</div><div style="color: #0433ff; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><b>activate</b></div><div style="color: #0433ff; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><b>make</b><span style="color: black;"> </span>new<span style="color: black;"> </span><i>document</i></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> <span style="color: #4f8f00;">n</span> <b>to</b> <span style="color: #4f8f00;">documentName</span> &amp; " - Annotation Summary.txt"</div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>tell</b> <b>front</b> <span style="color: #0433ff;"><i>document</i></span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> <b>its</b> <span style="color: #0433ff;"><i>text</i></span> <b>to</b> (<span style="color: #012fbe;"><b>the clipboard</b></span>)</div><div style="font-family: Verdana; font-size: 12px; margin-left: 117.8px; text-indent: -117.8px;"><span class="Apple-tab-span" style="white-space: pre;">  </span><b>set</b> <b>its</b> <span style="color: #812fdc;">name</span> <b>to</b> <span style="color: #4f8f00;">n</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>end</b> <b>tell</b></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span>-- save document 1 in ((documentFile as text) &amp; " - Annotation Summary.txt")</div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;"><b>end</b> <b>tell</b></div><div style="font-family: Verdana; font-size: 12px; margin-left: 39.2px; min-height: 15px; text-indent: -39.3px;"><br /></div><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;">-- Yes, this is how to replace characters with AppleScript.&nbsp; No comment.</div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;"><span style="color: black;"><b>on</b> </span>replace_chars<span style="color: black;">(</span>this_text<span style="color: black;">, </span>search_string<span style="color: black;">, </span>replacement_string<span style="color: black;">)</span></div><div style="color: #812fdc; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> </span>AppleScript<span style="color: black;">'s </span>text item delimiters<span style="color: black;"> <b>to</b> <b>the</b> </span><span style="color: #4f8f00;">search_string</span></div><div style="font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> <b>the</b> <span style="color: #4f8f00;">item_list</span> <b>to</b> <b>every</b> <span style="color: #0433ff;"><i>text item</i></span> <b>of</b> <span style="color: #4f8f00;">this_text</span></div><div style="color: #812fdc; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> </span>AppleScript<span style="color: black;">'s </span>text item delimiters<span style="color: black;"> <b>to</b> <b>the</b> </span><span style="color: #4f8f00;">replacement_string</span></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> </span>this_text<span style="color: black;"> <b>to</b> <b>the</b> </span>item_list<span style="color: black;"> <b>as</b> </span><span style="color: #0433ff;"><i>string</i></span></div><div style="color: #812fdc; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>set</b> </span>AppleScript<span style="color: black;">'s </span>text item delimiters<span style="color: black;"> <b>to</b> ""</span></div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 78.5px; text-indent: -78.6px;"><span style="color: black;"><span class="Apple-tab-span" style="white-space: pre;"> </span><b>return</b> </span>this_text</div><div style="color: #4f8f00; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;"><span style="color: black;"><b>end</b> </span>replace_chars</div></div><div><br /><div style="color: #5e6161; font-family: Verdana; font-size: 12px; margin-left: 39.2px; text-indent: -39.3px;"></div><div style="margin-left: 39.2px; min-height: 15px; text-indent: -39.3px;"><br /></div><br /></div>