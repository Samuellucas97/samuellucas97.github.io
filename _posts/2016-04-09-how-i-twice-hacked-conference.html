---
layout: post
title: Four security flaws illustrated, all on one conference registration site
date: '2016-04-09T07:15:00.000+02:00'
author: Andreas Zeller
tags: 
modified_time: '2016-04-12T09:19:27.076+02:00'
thumbnail: https://1.bp.blogspot.com/-BTaBLAMavD8/Vwh6BxebMzI/AAAAAAAAA5Y/AbjF5aGEQU8D3HZ_evcgOoMirYziB5ijA/s72-c/Screen%2BShot%2B2016-04-08%2Bat%2B21.35.14.png
blogger_id: tag:blogger.com,1999:blog-8747085902902510837.post-6775097006523046439
blogger_orig_url: https://andreas-zeller.blogspot.com/2016/04/how-i-twice-hacked-conference.html
---

When you're organizing a big scientific conference – conventions where scientists from across the world would convene to exchange their latest and greatest –, you have to think about zillions of different things: rooms, projectors, food, coffee, budget, accommodations, badges, speakers, leaflets, dinners, just to name a few. &nbsp;It is impossible not to make mistakes, but it is generally possible to fix them once you know. &nbsp;The worst mistakes, though, are the ones you never thought they could be made.<br /><br />Some time ago, I registered for one of these scientific conferences. &nbsp;The process is simple: You enter your details, select optional packages, finally enter your credit card data, and you're done. &nbsp;This being a computer science conference, you would think your data is all secure in the hand of experts. &nbsp;As I can now tell you from experience, this assumption is wrong. &nbsp;Very wrong. &nbsp;This single registration system contained not just one security flaw, but&nbsp;<i>four</i>&nbsp;– all independent of each other.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-BTaBLAMavD8/Vwh6BxebMzI/AAAAAAAAA5Y/AbjF5aGEQU8D3HZ_evcgOoMirYziB5ijA/s1600/Screen%2BShot%2B2016-04-08%2Bat%2B21.35.14.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="250" src="https://1.bp.blogspot.com/-BTaBLAMavD8/Vwh6BxebMzI/AAAAAAAAA5Y/AbjF5aGEQU8D3HZ_evcgOoMirYziB5ijA/s400/Screen%2BShot%2B2016-04-08%2Bat%2B21.35.14.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">My Registration Screen</td></tr></tbody></table><br /><h2>Security Flaw #1: The identifiable ID, or How I would be able to access the data of every conference participant</h2>The fun began when I got my confirmation e-mail. &nbsp;Apparently, I was the first person to have registered with the conference – because my participant number was one. &nbsp;("Hey – look at me; I am participant number one!" I said.) &nbsp;In my e-mail, I also got a link with which I would be able to access my registration. &nbsp;Following it would immediately lead me to the above registration screen.<br /><br /><a href="http://4.bp.blogspot.com/-XeHDYEL2TTQ/Vwh8OJO1R3I/AAAAAAAAA5k/xtc48xrOtj4f-lEX2sZjyK8crIocBR2Uw/s1600/Screen%2BShot%2B2016-04-08%2Bat%2B21.47.02.png" imageanchor="1"><img alt="" border="0" height="140" src="https://4.bp.blogspot.com/-XeHDYEL2TTQ/Vwh8OJO1R3I/AAAAAAAAA5k/xtc48xrOtj4f-lEX2sZjyK8crIocBR2Uw/s640/Screen%2BShot%2B2016-04-08%2Bat%2B21.47.02.png" title="" width="640" /></a><br /><br />The link was a bit unusual, because it would not contain any other "secret" information or token other than my participant number, though. &nbsp;(You might assume it would encode my name, my ZIP code, or some other information tied to me only.) &nbsp;So I asked myself: What would happen if I change the link from "?parm1=1" to, say, "?parm1=2" – that is, participant number two? &nbsp;I entered the link into my browser, and immediately, I saw the registration screen of Lars Grunske, a colleague of mine in Stuttgart, Germany.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-PifnUoFDR-c/Vwh-yHBZyuI/AAAAAAAAA54/f9sF6yJV3wEEgXP-NgArMjMbkYYzrxQew/s1600/Screen%2BShot%2B2016-04-08%2Bat%2B22.00.04.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="266" src="https://4.bp.blogspot.com/-PifnUoFDR-c/Vwh-yHBZyuI/AAAAAAAAA54/f9sF6yJV3wEEgXP-NgArMjMbkYYzrxQew/s400/Screen%2BShot%2B2016-04-08%2Bat%2B22.00.04.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Lars Grunske's registration screen</td></tr></tbody></table><br />Now having the same privileges as Lars, I would be able to read and change all data at will. &nbsp;The idea arose to have him buy a few extra dinner tickets at his expense, but only briefly so. &nbsp;Trying the same for further participants gave the same (Hi Abhik!, &nbsp;¡Hola Yasiel!).<br /><br />In 2011, a similar mistake was made by UNESCO, who also used consecutive numbers for its internship applicants, and who thus leaked hundreds of thousands of applicant records on the Web. &nbsp;(<a href="http://www.spiegel.de/netzwelt/web/datenleck-bei-uno-organisation-unesco-entbloesst-hunderttausende-bewerber-im-web-a-759538.html" target="_blank">German Article</a>&nbsp;on Spiegel.de) &nbsp;What do you do when you discover such a problem? &nbsp;To protect the integrity of participant data, I dutifully reported the problem to the organizers, who immediately replied the issue would be fixed as soon as possible.<br /><br /><b><i><span style="color: red;">Lesson 1: When handling personal data, set it up such that&nbsp;access requires a secret that cannot be easily guessed.</span></i></b><br /><b><i><span style="color: red;"><br /></span></i></b><br /><h3></h3><h2>Security Flaw #2: The Unsanitized input, or How I easily bypassed password checks</h2>The next day, I got a new mail from the organizers. &nbsp;In addition to lots of high end security stuff (which would not protect from guessing a participant number), they now had introduced a secret word only known to the registrant, commonly known as a password.<br /><br /><a href="http://3.bp.blogspot.com/-qLqTt2AQVXo/VwiBY9vtaGI/AAAAAAAAA6I/11ddVqP-fhQPT540mj2thU3XkhgbYdR6Q/s1600/Screen%2BShot%2B2016-04-08%2Bat%2B22.08.26.png" imageanchor="1"><img border="0" height="138" src="https://3.bp.blogspot.com/-qLqTt2AQVXo/VwiBY9vtaGI/AAAAAAAAA6I/11ddVqP-fhQPT540mj2thU3XkhgbYdR6Q/s640/Screen%2BShot%2B2016-04-08%2Bat%2B22.08.26.png" width="640" /></a><br /><br />Okay. &nbsp;I went to the site, and it indeed now requested that I enter my ID and password.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-Mkrte_nlNPc/VwiCB6fiTII/AAAAAAAAA6U/MxNjUQU7C8QjyQGeuYCnV6WZ4uvz_qmcA/s1600/Screen%2BShot%2B2016-04-08%2Bat%2B22.15.44.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="125" src="https://4.bp.blogspot.com/-Mkrte_nlNPc/VwiCB6fiTII/AAAAAAAAA6U/MxNjUQU7C8QjyQGeuYCnV6WZ4uvz_qmcA/s400/Screen%2BShot%2B2016-04-08%2Bat%2B22.15.44.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Revised login interstitial screen</td></tr></tbody></table>Problem solved? Not at all. &nbsp;I sent the above mail to my Post-Docs Marcel and Juan Pablo "JP" Galeotti, whom I had talked about the problem the day before. &nbsp;Minutes later, Marcel Böhme sent me back an intriguing message:<br /><br /><a href="http://3.bp.blogspot.com/-JYjdYWSYr2Y/VwiCmvKalpI/AAAAAAAAA6g/UkCuNnBssU4uE43_CYn13Wx7IbhwGbWGQ/s1600/Screen%2BShot%2B2016-04-08%2Bat%2B22.18.02.png" imageanchor="1"><img border="0" height="75" src="https://3.bp.blogspot.com/-JYjdYWSYr2Y/VwiCmvKalpI/AAAAAAAAA6g/UkCuNnBssU4uE43_CYn13Wx7IbhwGbWGQ/s640/Screen%2BShot%2B2016-04-08%2Bat%2B22.18.02.png" width="640" /></a><br /><br />Incredible. &nbsp;Could one really attack the system this way? &nbsp;Ten minutes later, JP chimed in with<br /><br /><a href="http://1.bp.blogspot.com/-AyPI1EnzQBs/VwiDLGBe0BI/AAAAAAAAA6w/2WQn710EULkum5IVLUdsSporvoWss3Vsg/s1600/Screen%2BShot%2B2016-04-08%2Bat%2B22.20.21.png" imageanchor="1"><img border="0" height="102" src="https://1.bp.blogspot.com/-AyPI1EnzQBs/VwiDLGBe0BI/AAAAAAAAA6w/2WQn710EULkum5IVLUdsSporvoWss3Vsg/s640/Screen%2BShot%2B2016-04-08%2Bat%2B22.20.21.png" width="640" /></a><br /><br />Ha! &nbsp;Indeed, this worked like a charm. &nbsp;Eventually, I would simply enter "<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">2' -- </span>" as my ID, and any string as my password – and again, I would be Lars Grunske, and would be able to alter his data at will. &nbsp;Likewise, anyone with the above trick could do the same to my data. <br /><br />How does this work? &nbsp;Internally, the conference registration system uses a database that is controlled by so-called SQL commands. &nbsp;When I enter my ID, say, "1", and my password, say, "1234", the system selects my data from the database using a SQL command looking like this:<br /><br />&nbsp; &nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">SELECT * FROM REGISTRATIONS WHERE ID = '1' AND PASSWORD = '1234'</span><br /><br />Note how the number I entered as ID ("1") becomes part of the command. &nbsp;By entering "<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">2' -- </span>" as ID and "whatever" as password. we get the command<br /><br />&nbsp; &nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">SELECT * FROM REGISTRATIONS WHERE ID = '2' -- 'AND PASSWORD = 'whatever'</span><br /><br />In a SQL command, anything starting with two dashes "--" is treated as a comment and ignored. &nbsp;So the system simply fetches the data from the registrant whose ID is 2, <i>ignoring</i> the password. &nbsp;This is known as a&nbsp;<a href="https://en.wikipedia.org/wiki/SQL_injection" target="_blank">SQL injection</a>&nbsp;attack, and the standard way to avoid these is to filter out all characters that would have a special meaning in SQL commands (like "'" or "--").<br /><br />Refining my ID to, say, "<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">2'; DROP TABLE REGISTRATIONS; -- </span>", I might even have been able to <i>delete</i> all registration data. &nbsp;(I hope they do backups!) &nbsp;How could one set up a SQL-based system and never have heard about <a href="https://en.wikipedia.org/wiki/SQL_injection" target="_blank">SQL injection</a>? &nbsp;Now this was beginning to get embarrassing.<br /><br /><b><i><span style="color: red;">Lesson 2: When setting up a publicly accessible service, identify common attack vectors and protect against them – for Web sites: buffer overflows, SQL injection, cross-site scripting, etc.</span></i></b><br /><b><i><span style="color: red;"><br /></span></i></b><br /><div><h3></h3><h2>Security Flaw #3: &nbsp;Plaintext Passwords, or How I would now also steal personal passwords from all participants</h2></div><div>But the embarrassment was not over yet. &nbsp;Remember how the e-mail above asked users to set up their own passwords? &nbsp;It turned out that the passwords were actually <i>stored and displayed in the clear</i>, as seen on Lars' revised registration screen:</div><div><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-jk61OivwS9s/VwiGy86ugxI/AAAAAAAAA7A/QlXu5s-wwocdXX-yZg8H0XX3oDDgVQ_uA/s1600/Screen%2BShot%2B2016-04-08%2Bat%2B22.31.35.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="290" src="https://4.bp.blogspot.com/-jk61OivwS9s/VwiGy86ugxI/AAAAAAAAA7A/QlXu5s-wwocdXX-yZg8H0XX3oDDgVQ_uA/s400/Screen%2BShot%2B2016-04-08%2Bat%2B22.31.35.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Lars Grunske's registration screen, now with password</td></tr></tbody></table><br />The password listed was Lars' password; saving it would allow me to log in with his user ID and password. &nbsp;I could easily have skimmed all passwords of all participants and I could have logged in long after the SQL vulnerability had been fixed.<br /><br />But storing passwords in the clear is a bad practice for many more reasons. &nbsp;It gives the administrator access to all passwords, which provides an opportunity for thefts. &nbsp;Plus, and this is probably the worst: Many people tend to use<i> the same passwords for different sites.</i> &nbsp;Had Lars indeed changed his password as requested, and for instance chosen the same password he would use for Amazon or eBay, I would be able to log in at these sites on his behalf, and happily order stuff.<br /><br />Had Lars used the same password he also uses for his mail, I could have accessed <i>all</i>&nbsp;of his passwords, everywhere – a simple click on "I have forgotten my password" links would have triggered "password reset" mails to his account, which I could easily have skimmed. &nbsp;I'm a nice guy, so I did none of this. &nbsp;(Plus, I have a cool joint research project with Lars.)<br /><br />To cut a long story short: I sent another urgent report to the organizer, and hours later, the SQL vulnerability was closed. &nbsp;The one we had found, that is. &nbsp;No idea whether other vulnerabilities would be hidden somewhere in there, or how the system had been tested for security, if at all.<br /><br /><b><i><span style="color: red;">Lesson 3: Passwords should never be stored, displayed, or transmitted in the clear. &nbsp;Store hashes instead; and if a user requests a&nbsp;new password, create a new one instead.</span></i></b><br /><b><i><span style="color: red;"><br /></span></i></b><br /><div><h3></h3><h2>Security Flaw #4: Compromised Forever, or How nobody would be able to change their passwords</h2></div>Was it really the case that Lars had ignored the instructions and kept his original password? &nbsp;After all that had happened, I thought that maybe someone had done the same that I had done, and thus now had access to my conference password. &nbsp;So I decided to change it online. &nbsp;However, it turned out that <i>changing the password did not work</i> – you would always retain the old one, which would still be happily displayed for you. &nbsp;The good news was that this way, nobody would have been able to reuse existing passwords – and anyway, had I really wanted my password changed, another mail to the organizers might have done the trick. &nbsp;At this point, I decided not to further stress the relationship between the organizers and their software developers and leave this be.<br /><br /><b><i><span style="color: red;">Lesson 4: Always allow&nbsp;your users to reset their access data if they fear it may have been compromised.</span></i></b><br /><div><br /></div>All was well that ended well: The conference was truly magnificent, and as far as I know, nobody's data got compromised in any way. &nbsp;Of course, anybody could have gone through the steps described above, skimming data without ever reporting. &nbsp;But luckily, the first registrant (me) pointed out the issues before some fraudster could have spotted it, and of course, any of my colleagues would have done just the same. &nbsp;When your customers are nice people, consider yourself lucky.<br /><br /><div><h2>Post Scriptum: The Horrible Homebrew, or Why it may be better to build on well-tested platforms</h2></div><div>This brings me to the meta lesson to be learned here – and this tells something about process rather than product.&nbsp;&nbsp;If you set up a system from scratch, be it a conference management system, a shop, a student registration system, whatever, be aware of the many risks this entails, and be sure to have independent and thorough security testing. &nbsp;Using an existing, established, well-tested system instead may lower risk and overall cost, even if it may cost more upfront. &nbsp;When the damage is done, you wish you had decided differently – but then, it may be too late.</div><br /><i><b><span style="color: red;">Final Lesson:&nbsp;</span></b></i><i><b><span style="color: red;">&nbsp;When deciding between building and using a system, consider all risks and associated costs.</span></b></i><i><b><span style="color: red;">&nbsp;If you build a new system, thoroughly test it for security. &nbsp;If you use an existing system, be sure it is well tested.</span></b></i>